{
  "id": "{{service.name}}",
  "cpus": 1.0,
  "mem": 2048,
  "instances": 1,
  "cmd": "export LD_LIBRARY_PATH=$MESOS_SANDBOX/libmesos-bundle/lib:$LD_LIBRARY_PATH; export MESOS_NATIVE_JAVA_LIBRARY=$(ls $MESOS_SANDBOX/libmesos-bundle/lib/libmesos-*.so); export JAVA_HOME=$(ls -d $MESOS_SANDBOX/jre*/); export JAVA_HOME=${JAVA_HOME%/}; export PATH=$(ls -d $JAVA_HOME/bin):$PATH && ./alluxio-enterprise-scheduler/bin/alluxio-enterprise ./alluxio-enterprise-scheduler/svc.yml",
  "labels": {
    "DCOS_COMMONS_API_VERSION": "v1",
    "DCOS_COMMONS_UNINSTALL": "true",
    "DCOS_PACKAGE_FRAMEWORK_NAME": "{{service.name}}",
    "MARATHON_SINGLE_INSTANCE_APP": "true",
    "DCOS_SERVICE_NAME": "{{service.name}}",
    "DCOS_SERVICE_PORT_INDEX": "0",
    "DCOS_SERVICE_SCHEME": "http"
  },
  {{#service.secret_name}}
  "secrets": {
    "serviceCredential": {
      "source": "{{service.secret_name}}"
    }
  },
  {{/service.secret_name}}
  "env": {
    "ALLUXIO_VERSION": "{{service.alluxio-version}}",
    "ALLUXIO_DISTRIBUTION": "{{service.alluxio-distribution}}",
    "ALLUXIO_EXTRA_CLIENT_PROPERTIES": "{{advanced.extra-client-properties}}",
    "ALLUXIO_EXTRA_JAVA_OPTS": "{{advanced.extra-java-opts}}",
    "ALLUXIO_EXTRA_USER_JAVA_OPTS": "{{advanced.extra-user-java-opts}}",
    "ALLUXIO_EXTRA_MASTER_JAVA_OPTS": "{{advanced.extra-master-java-opts}}",
    "ALLUXIO_EXTRA_WORKER_JAVA_OPTS": "{{advanced.extra-worker-java-opts}}",
    "ALLUXIO_EXTRA_JOB_MASTER_JAVA_OPTS": "{{advanced.extra-job-master-java-opts}}",
    "ALLUXIO_EXTRA_JOB_WORKER_JAVA_OPTS": "{{advanced.extra-job-worker-java-opts}}",
    "ALLUXIO_EXTRA_ENV": "{{advanced.extra-env}}",
    "ALLUXIO_LICENSE": "{{service.license}}",
    "ALLUXIO_URI": "{{resource.assets.uris.alluxio-bootstrap}}",
    "ALLUXIO_RAM_FOLDER_HOME": "/opt",
    "ALLUXIO_RAM_FOLDER_NAME": "alluxio-mem",
    "ALLUXIO_TMPFS_LOCATION": "/dev/shm",
    "BOOTSTRAP_URI": "{{resource.assets.uris.bootstrap-zip}}",
    "CONFIG_TEMPLATE_PATH": "alluxio-enterprise-scheduler",

    {{#service.secret_name}}
    "DCOS_SERVICE_ACCOUNT_CREDENTIAL": { "secret": "serviceCredential" },
    "MESOS_MODULES": "{\"libraries\": [{\"file\": \"libdcos_security.so\", \"modules\": [{\"name\": \"com_mesosphere_dcos_ClassicRPCAuthenticatee\"}]}]}",
    "MESOS_AUTHENTICATEE": "com_mesosphere_dcos_ClassicRPCAuthenticatee",
    {{/service.secret_name}}

    "EXECUTOR_URI": "{{resource.assets.uris.executor-zip}}",
    "LIBMESOS_URI": "{{resource.assets.uris.libmesos-bundle-tar-gz}}",
    "FRAMEWORK_NAME": "{{service.name}}",
    "FRAMEWORK_PRINCIPAL": "{{service.principal}}",
    "FRAMEWORK_USER": "{{service.user}}",
    "SECRET_NAME": "{{service.secret_name}}",
    "JAVA_URI": "{{resource.assets.uris.jre-tar-gz}}",
    "TASKCFG_ALL_ALLUXIO_LOGLEVEL": "{{general.loglevel}}",
    "MASTER_COUNT": "1",
    "WORKER_COUNT": "{{service.worker-count}}",
    "JOB_MASTER_COUNT": "1",
    "JOB_WORKER_COUNT": "1",
    "UFS_ADDRESS": "{{service.ufs-address}}",
    "LOG_LEVEL": "{{service.log-level}}",
    "DOCKER_PUBLISH": "{{service.docker-publish}}",
    "DOCKER_PUBLISH_URL": "{{service.docker-publish-url}}",
    "DOCKER_ALLUXIO_CLIENT": "{{docker.alluxio-client}}",
    "DOCKER_ALLUXIO_CLIENT_APK_ADD_BASH": "{{docker.alluxio-client-apk-add-bash}}",
    "DOCKER_ALLUXIO_CLIENT_BASE": "{{docker.alluxio-client-base}}",
    "DOCKER_SPARK_CLIENT": "{{docker.spark-client}}",
    "DOCKER_SPARK_CLIENT_BASE": "{{docker.spark-client-base}}",
    "DOCKER_SPARK_DIST_HOME": "{{docker.spark-dist-home}}",
    "OFFLINE_MODE": "{{service.offline-mode}}",
    "OFFLINE_MODE_DOWNLOAD_URL": "{{service.offline-mode-download-url}}",
    "AWS_ACCESS_KEY": "{{s3a.aws-access-key}}",
    "AWS_SECRET_KEY": "{{s3a.aws-secret-key}}",
    "HDFS_ENABLE_ENDPOINTS": "{{hdfs.enable-endpoints}}",
    "HDFS_SERVICE_ENDPOINTS": "{{hdfs.service-endpoints}}",
    "HDFS_KERBEROS": "{{hdfs.kerberos}}",
    "SWIFT_USER": "{{swift.swift-user}}",
    "SWIFT_TENANT": "{{swift.swift-tenant}}",
    "SWIFT_AUTH_URL": "{{swift.swift-auth-url}}",
    "SWIFT_PASSWORD": "{{swift.swift-password}}",
    "SWIFT_AUTH_METHOD": "{{swift.swift-auth-method}}",
    "SWIFT_USE_PUBLIC_URL": "{{swift.swift-use-public-url}}",
    "SWIFT_REGION": "{{swift.swift-region}}",
    "MASTER_CPUS": "{{master.cpus}}",
    "MASTER_MEM": "{{master.mem}}",
    "MASTER_DISK": "{{master.disk}}",
    "MASTER_DISK_TYPE": "{{master.disk-type}}",
    "MASTER_PLACEMENT": "{{master.placement}}",
    "WORKER_CPUS": "{{worker.cpus}}",
    "WORKER_MEM": "{{worker.mem}}",
    "WORKER_DISK": "{{worker.disk}}",
    "WORKER_DISK_TYPE": "{{worker.disk-type}}",
    "WORKER_PLACEMENT": "{{worker.placement}}",
    "JOB_MASTER_CPUS": "1",
    "JOB_MASTER_MEM": "2048",
    "JOB_MASTER_DISK": "2048",
    "JOB_MASTER_DISK_TYPE": "ROOT",
    "JOB_MASTER_PLACEMENT": "",
    "JOB_WORKER_CPUS": "1",
    "JOB_WORKER_MEM": "2048",
    "JOB_WORKER_DISK": "2048",
    "JOB_WORKER_DISK_TYPE": "ROOT",
    "JOB_WORKER_PLACEMENT": "",
    "DOCKER_CPUS": "1",
    "DOCKER_MEM": "4096",
    "DOCKER_DISK": "4096",
    "DOCKER_DISK_TYPE": "ROOT",
    "DOCKER_PLACEMENT": "",
    "ALLUXIO_MASTER_PORT": "{{network.master-port}}",
    "ALLUXIO_MASTER_WEB_PORT": "{{network.master-web-port}}",
    "ALLUXIO_WORKER_PORT": "{{network.worker-port}}",
    "ALLUXIO_WORKER_DATA_PORT": "{{network.worker-data-port}}",
    "ALLUXIO_WORKER_WEB_PORT": "{{network.worker-web-port}}",
    "ALLUXIO_JOB_MASTER_PORT": "{{network.job-master-port}}",
    "ALLUXIO_JOB_MASTER_WEB_PORT": "{{network.job-master-web-port}}",
    "ALLUXIO_JOB_WORKER_PORT": "{{network.job-worker-port}}",
    "ALLUXIO_JOB_WORKER_DATA_PORT": "{{network.job-worker-data-port}}",
    "ALLUXIO_JOB_WORKER_WEB_PORT": "{{network.job-worker-web-port}}",
    "SECURITY_AUTHENTICATION_TYPE": "{{security.authentication-type}}",
    "SECURITY_AUTHORIZATION_PERMISSION_ENABLED": "{{security.authorization-permission-enabled}}",
    "SECURITY_DOWNLOAD_KEYTAB": "{{security.download-keytab}}",
    "SECURITY_KEYTAB_URI": "{{security.keytab-uri}}",
    "SECURITY_KERBEROS_PRIMARY": "{{security.kerberos-primary}}",
    "SECURITY_KERBEROS_INSTANCE": "{{security.kerberos-instance}}",
    "SECURITY_KERBEROS_REALM": "{{security.kerberos-realm}}",
    "SECURITY_KRB5_URI": "{{security.krb5-uri}}",
    "PROXYLITE_CPUS": "{{master.cpus}}",
    "PROXYLITE_MEM": "{{master.mem}}",
    "PROXYLITE_PORT": "{{network.proxylite-port}}"
  },
  "uris": [
    "{{resource.assets.uris.jre-tar-gz}}",
    "{{resource.assets.uris.scheduler-zip}}",
    "{{resource.assets.uris.libmesos-bundle-tar-gz}}"
  ],
  "upgradeStrategy":{
    "minimumHealthCapacity": 0,
    "maximumOverCapacity": 0
  },
  "portDefinitions": [
    {
      "port": 0,
      "protocol": "tcp",
      "name": "api",
      "labels": { "VIP_0": "/api.{{service.name}}:80" }
    }
  ]
}
