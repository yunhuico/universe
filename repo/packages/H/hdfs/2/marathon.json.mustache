{
  "id": "{{hdfs.framework-name}}",
  "cpus": {{hdfs.cpus}},
  "mem": {{hdfs.mem}},
  "disk": {{hdfs.disk-size}},
  "instances": {{hdfs.instances}},
  "env": {
	"LD_LIBRARY_PATH": "{{hdfs.ld-library-path}}",
	"MESOS_HDFS_LD_LIBRARY_PATH" : "{{hdfs.ld-library-path}}",
    "MESOS_HDFS_FRAMEWORK_NAME" : "{{hdfs.framework-name}}",
    "MESOS_HDFS_ROLE" : "{{hdfs.role}}",
	"MESOS_HDFS_USER" : "{{hdfs.mesos-hdfs-user}}",
	"MESOS_HDFS_PRINCIPAL" : "{{hdfs.principal}}",

    "DFS_NAMESERVICE_ID" : "hdfs",
    "DFS_NAMESERVICES" : "hdfs",
    "HA_ZOOKEEPER_QUORUM" : "{{hdfs.ha-zookeeper-quorum}}",

	"DFS_JOURNALNODE_EDITS_DIR" : "{{hdfs.dfs-journalnode-edits-dir}}",
	"DFS_NAMENODE_NAME_DIR" : "{{hdfs.dfs-namenode-name-dir}}",
	"DFS_DATANODE_DATA_DIR" : "{{hdfs.dfs-datanode-data-dir}}",
	"DFS_DOMAIN_SOCKET_PATH" : "{{hdfs.dfs-domain-socket-path}}",
	"DFS_HA_AUTOMATIC__DASH__FAILOVER_ENABLED" : "{{hdfs.dfs-ha-automatic-failover-enabled}}",
	"DFS_CLIENT_FAILOVER_PROXY_PROVIDER_HDFS" : "{{hdfs.dfs-client-failover-proxy-provider-hdfs}}",
	"DFS_HA_FENCING_METHODS" : "{{hdfs.dfs-ha-fencing-methods}}",
	"DFS_PERMISSIONS" : "{{hdfs.dfs-permissions}}",
	"MESOS_HDFS_HEALTHCHECK_FREQUENCY_MS" : "{{hdfs.mesos-hdfs-healthcheck-frequency-ms}}",
	"MESOS_HDFS_HEALTHCHECK_WAITINGPERIOD_MS" : "{{hdfs.mesos-hdfs-healthcheck-waitingperiod-ms}}",
	"DFS_DATANODE_DU_RESERVED" : "{{hdfs.dfs-datanode-du-reserved}}",
	"DFS_DATANODE_BALANCE_BANDWIDTHPERSEC" : "{{hdfs.dfs-datanode-balance-bandwidthPerSec}}",
	"DFS_NAMENODE_SAFEMODE_THRESHOLD__DASH__PCT" : "{{hdfs.dfs-namenode-safemode-threshold-pct}}",
	"DFS_NAMENODE_HEARTBEAT_RECHECK__DASH__INTERVAL" : "{{hdfs.dfs-namenode-heartbeat-recheck-interval}}",
	"DFS_DATANODE_HANDLER_COUNT" : "{{hdfs.dfs-datanode-handler-count}}",
	"DFS_NAMENODE_HANDLER_COUNT" : "{{hdfs.dfs-namenode-handler-count}}",
	"DFS_IMAGE_COMPRESS" : "{{hdfs.dfs-image-compress}}",
	"DFS_IMAGE_COMPRESSION_CODEC" : "{{hdfs.dfs-image-compression-codec}}",
	"DFS_NAMENODE_INVALIDATE_WORK_PCT_PER_ITERATION" : "{{hdfs.dfs-namenode-invalidate-work-pct-per-iteration}}",
	"DFS_NAMENODE_REPLICATION_WORK_MULTIPLIER_PER_ITERATION" : "{{hdfs.dfs-namenode-replication-work-multiplier-per-iteration}}",
	"DFS_CLIENT_READ_SHORTCIRCUIT" : "{{hdfs.dfs-client-read-shortcircuit}}",
	"DFS_CLIENT_READ_SHORTCIRCUIT_STREAMS_CACHE_SIZE" : "{{hdfs.dfs-client-read-shortcircuit-streams-cache-size}}",
	"DFS_CLIENT_READ_SHORTCIRCUIT_STREAMS_CACHE_SIZE_EXPIRY_MS" : "{{hdfs.dfs-client-read-shortcircuit-streams-cache-size-expiry-ms}}",

	"MESOS_HDFS_DATANODE_EXCLUSIVE" : "{{hdfs.mesos-hdfs-datanode-exclusive}}",
	"MESOS_HDFS_JOURNALNODE_COUNT" : "{{hdfs.mesos-hdfs-journalnode-count}}",
	"MESOS_HDFS_DATANODE_COUNT" : "{{hdfs.mesos-hdfs-datanode-count}}",
	"MESOS_HDFS_CONFIG_SERVER_PORT" : "{{hdfs.mesos-hdfs-config-server-port}}",
	"MESOS_HDFS_CONFIG_PATH" : "{{hdfs.mesos-hdfs-config-path}}",
	"MESOS_FAILOVER_TIMEOUT_SEC" : "{{hdfs.mesos-failover-timeout-sec}}",
	"MESOS_HDFS_NATIVEHADOOPBINARIES" : "{{hdfs.mesos-hdfs-native-hadoop-binaries}}",
	"MESOS_HDFS_FRAMEWORK_MNT_PATH" : "{{hdfs.mesos-hdfs-framework-mnt-path}}",
	"MESOS_HDFS_STATE_ZK" : "{{hdfs.mesos-hdfs-state-zk}}",
	"MESOS_MASTER_URI" : "{{hdfs.mesos-master-uri}}",
	"MESOS_HDFS_MESOSDNS" : "{{hdfs.mesos-hdfs-mesosdns}}",
	"MESOS_HDFS_MESOSDNS_DOMAIN" : "{{hdfs.mesos-hdfs-mesosdns-domain}}",
	"MESOS_HDFS_JVM_OVERHEAD" : "{{hdfs.mesos-hdfs-jvm-overhead}}",
	"MESOS_HDFS_JVM_OPTS" : "{{hdfs.mesos-hdfs-jvm-opts}}",
	"MESOS_HDFS_NAMENODE_CPUS" : "{{hdfs.mesos-hdfs-namenode-cpus}}",
	"MESOS_HDFS_DATANODE_CPUS" : "{{hdfs.mesos-hdfs-datanode-cpus}}",
	"MESOS_HDFS_EXECUTOR_CPUS" : "{{hdfs.mesos-hdfs-executor-cpus}}",
	"MESOS_HDFS_JOURNALNODE_CPUS" : "{{hdfs.mesos-hdfs-journalnode-cpus}}",
	"MESOS_HDFS_HADOOP_HEAP_SIZE" : "{{hdfs.mesos-hdfs-hadoop-heap-size}}",
	"MESOS_HDFS_DATANODE_HEAP_SIZE" : "{{hdfs.mesos-hdfs-datanode-heap-size}}",
	"MESOS_HDFS_NAMENODE_HEAP_SIZE" : "{{hdfs.mesos-hdfs-namenode-heap-size}}",
	"MESOS_HDFS_JOURNALNODE_HEAP_SIZE" : "{{hdfs.mesos-hdfs-journalnode-heap-size}}",
	"MESOS_HDFS_EXECUTOR_HEAP_SIZE" : "{{hdfs.mesos-hdfs-executor-heap-size}}",
	"MESOS_HDFS_LOG_LEVEL" : "{{hdfs.mesos-hdfs-log-level}}",
	"MESOS_HDFS_JRE_VERSION" : "{{hdfs.jre-version}}",
	"MESOS_HDFS_JRE_URL" : "{{resource.assets.uris.jre-7u76-linux-x64-tar-gz}}",
	"DFS_NAMENODE_DATANODE_REGISTRATION_IP__DASH__HOSTNAME__DASH__CHECK" : "{{hdfs.dfs-namenode-datanode-registration-ip-hostname-check}}",

	"DFS_HA_NAMENODES_HDFS" : "{{hdfs.dfs-ha-namenodes-hdfs}}"
  },
  "cmd": "export JAVA_HOME=$MESOS_DIRECTORY/{{hdfs.jre-version}} && cd {{hdfs.framework-version}} && ./bin/hdfs-mesos",
  "uris": [
    "{{resource.assets.uris.hdfs-mesos-scheduler}}",
    "{{resource.assets.uris.jre-7u76-linux-x64-tar-gz}}"
  ],
  "healthChecks": [
    {
      "protocol": "COMMAND",
      "command": { "value": "export PATH=$MESOS_DIRECTORY/{{hdfs.framework-version}}/bin:$PATH && export JAVA_HOME=$MESOS_DIRECTORY/{{hdfs.jre-version}} && timeout 45s hadoop fs -ls hdfs://hdfs/ && rm -rf hdfs-framework-healthcheck && hadoop fs -rm -r -f hdfs://hdfs/hdfs-framework-healthcheck && hadoop fs -mkdir hdfs://hdfs/hdfs-framework-healthcheck && mkdir hdfs-framework-healthcheck && echo \"this is a test\" > hdfs-framework-healthcheck/test1.txt && hadoop fs -put hdfs-framework-healthcheck/test1.txt hdfs://hdfs/hdfs-framework-healthcheck && hadoop fs -get hdfs://hdfs/hdfs-framework-healthcheck/test1.txt hdfs-framework-healthcheck/test2.txt && rm -rf hdfs-framework-healthcheck && hadoop fs -rm -r -f hdfs://hdfs/hdfs-framework-healthcheck" },
      "gracePeriodSeconds": 300,
      "intervalSeconds": 60,
      "timeoutSeconds": 60,
      "maxConsecutiveFailures": 3
    }
  ]
}
